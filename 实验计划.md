### 损失函数
$$
\mathcal{L_1}=0.5\times\mathcal{L}_{cl1}+0.5\times \mathcal{L}_{mask}
$$

$$
\mathcal{L}_{mask}=-\sum_{\mathcal{G}\in \mathcal{D}}\sum_{\mathcal{i}\in \mathcal{M}} \log p(z_i|\mathcal{G}^{\mathcal{M}})
$$

$$
\mathcal{L}_{cl1}=-\sum_{\mathcal{G}\in \mathcal{D}}\log {e^{sim(h_{\mathcal{M}},h_{\mathcal{M}
_1})}\over \sum_{\mathcal{G'\in B}}e^{sim(h_{\mathcal{M}},h_{\mathcal{G'}})}}
$$

$$
\mathcal{L}_{2}=-\sum_{\mathcal{G}\in \mathcal{D}}\log {e^{sim(h_{\mathcal{M}},h'_{\mathcal{M}})}\over \sum_{\mathcal{G'\in B}}e^{sim(h_{\mathcal{M}},h_{\mathcal{G'}})}}
$$

$$
\mathcal{L} = \mathcal{L_1+L_2}
$$

### 对比实验
|  数据集|bbbp|bace|clintox|hiv|
| -------- | -------- | --------|--- |----|
| Mole-BERT论文| 71.9 |80.8	|78.9|78.2|
| Mole-BERT复现| 66.35 | 79.44 | 76.3 |76.70|
| MGCL-BERT | 62.54 | 78.65 |66.87|76.30|

### 实验一：去掉分词器,对比TMCL和提出的MGCL

| 数据集|bbbp|bace|clintox|hiv|
|-------- | -------- | -------- |----|---|
|TMCL论文| 67.6 |75.1|77.0|75.1|
|TMCL复现| 63.08|81.04|78.0|78.4|
| MGCL | 66.01 |78.42|67.1|77.7|

### 实验二：消融，比较遮蔽和扰动两种增强方式
|  数据集|bbbp|bace|clintox |hiv|
| -------- | -------- | -------- |----|----|
|Mask|64.76|80.38|71.74|78.48|
|FGCL|64.70|74.82|60.34|75.77|
| MGCL | 66.01 |78.42|67.1|77.7|